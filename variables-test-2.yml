# From: https://developercommunity.visualstudio.com/content/problem/1151302/inconsistent-behavior-between-variablessecuredVar-a.html

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

variables:
  securedVar:  ${{variables.securedVar}}
  publicVar:  ${{variables.publicVar}}
  unsetVar:  ${{variables.unsetVar}}

steps:
- script: |
    echo 'SECUREDVAR is:'               $SECUREDVAR
    echo 'securedVar_Macro is:'         $SECUREDVAR_MACRO
    echo 'securedVar_CompileTime is:'   $SECUREDVAR_COMPILETIME
    echo 'securedVar_Runtime is:'       $SECUREDVAR_RUNTIME
    echo 'securedVar_NoVariablesBlock_Macro is:'       $SECUREDVAR_NOVARIABLESBLOCK_MACRO
    echo 'securedVar_NoVariablesBlock_CompileTime is:' $SECUREDVAR_NOVARIABLESBLOCK_COMPILETIME
    echo 'securedVar_NoVariablesBlock_Runtime is:'     $SECUREDVAR_NOVARIABLESBLOCK_RUNTIME

    echo
    echo 'PUBLICVAR is:'             $PUBLICVAR
    echo 'publicVar_Macro is:'       $PUBLICVAR_MACRO
    echo 'publicVar_CompileTime is:' $PUBLICVAR_COMPILETIME
    echo 'publicVar_Runtime is:'     $PUBLICVAR_RUNTIME
    echo 'publicVar_NoVariablesBlock_Macro is:'       $PUBLICVAR_NOVARIABLESBLOCK_MACRO
    echo 'publicVar_NoVariablesBlock_CompileTime is:' $PUBLICVAR_NOVARIABLESBLOCK_COMPILETIME
    echo 'publicVar_NoVariablesBlock_Runtime is:'     $PUBLICVAR_NOVARIABLESBLOCK_RUNTIME

    echo
    echo 'UNSETVAR is:'             $UNSETVAR
    echo 'unsetVar_Macro is:'       $UNSETVAR_MACRO
    echo 'unsetVar_CompileTime is:' $UNSETVAR_COMPILETIME
    echo 'unsetVar_Runtime is:'     $UNSETVAR_RUNTIME
    echo 'unsetVar_NoVariablesBlock_Macro is:'       $UNSETVAR_NOVARIABLESBLOCK_MACRO
    echo 'unsetVar_NoVariablesBlock_CompileTime is:' $UNSETVAR_NOVARIABLESBLOCK_COMPILETIME
    echo 'unsetVar_NoVariablesBlock_Runtime is:'     $UNSETVAR_NOVARIABLESBLOCK_RUNTIME


  env:
    securedVar_Macro: $(securedVar)
    securedVar_CompileTime: ${{variables.securedVar}}
    securedVar_Runtime: $[variables.securedVar]
    securedVar_NoVariablesBlock_Macro: $(securedVar_NoVariablesBlock)
    securedVar_NoVariablesBlock_CompileTime: ${{variables.securedVar_NoVariablesBlock}}
    securedVar_NoVariablesBlock_Runtime: $[variables.securedVar_NoVariablesBlock]
    publicVar_Macro: $(publicVar)
    publicVar_CompileTime: ${{variables.publicVar}}
    publicVar_Runtime: $[variables.publicVar]
    publicVar_NoVariablesBlock_Macro: $(publicVar_NoVariablesBlock)
    publicVar_NoVariablesBlock_CompileTime: ${{variables.publicVar_NoVariablesBlock}}
    publicVar_NoVariablesBlock_Runtime: $[variables.publicVar_NoVariablesBlock]
    unsetVar_Macro: $(unsetVar)
    unsetVar_CompileTime: ${{variables.unsetVar}}
    unsetVar_Runtime: $[variables.unsetVar]
    unsetVar_NoVariablesBlock_Macro: $(unsetVar_NoVariablesBlock)
    unsetVar_NoVariablesBlock_CompileTime: ${{variables.unsetVar_NoVariablesBlock}}
    unsetVar_NoVariablesBlock_Runtime: $[variables.unsetVar_NoVariablesBlock]

- script: |
    echo
    echo 'info: No env: block is providfed for these echoes below here!'
    echo
    echo 'SECUREDVAR is:'               $SECUREDVAR
    echo 'securedVar_Macro is:'         $SECUREDVAR_MACRO
    echo 'securedVar_CompileTime is:'   $SECUREDVAR_COMPILETIME
    echo 'securedVar_Runtime is:'       $SECUREDVAR_RUNTIME
    echo 'securedVar_NoVariablesBlock_Macro is:'       $SECUREDVAR_NOVARIABLESBLOCK_MACRO
    echo 'securedVar_NoVariablesBlock_CompileTime is:' $SECUREDVAR_NOVARIABLESBLOCK_COMPILETIME
    echo 'securedVar_NoVariablesBlock_Runtime is:'     $SECUREDVAR_NOVARIABLESBLOCK_RUNTIME

    echo
    echo 'PUBLICVAR is:'             $PUBLICVAR
    echo 'publicVar_Macro is:'       $PUBLICVAR_MACRO
    echo 'publicVar_CompileTime is:' $PUBLICVAR_COMPILETIME
    echo 'publicVar_Runtime is:'     $PUBLICVAR_RUNTIME
    echo 'publicVar_NoVariablesBlock_Macro is:'       $PUBLICVAR_NOVARIABLESBLOCK_MACRO
    echo 'publicVar_NoVariablesBlock_CompileTime is:' $PUBLICVAR_NOVARIABLESBLOCK_COMPILETIME
    echo 'publicVar_NoVariablesBlock_Runtime is:'     $PUBLICVAR_NOVARIABLESBLOCK_RUNTIME

    echo
    echo 'UNSETVAR is:'             $UNSETVAR
    echo 'unsetVar_Macro is:'       $UNSETVAR_MACRO
    echo 'unsetVar_CompileTime is:' $UNSETVAR_COMPILETIME
    echo 'unsetVar_Runtime is:'     $UNSETVAR_RUNTIME
    echo 'unsetVar_NoVariablesBlock_Macro is:'       $UNSETVAR_NOVARIABLESBLOCK_MACRO
    echo 'unsetVar_NoVariablesBlock_CompileTime is:' $UNSETVAR_NOVARIABLESBLOCK_COMPILETIME
    echo 'unsetVar_NoVariablesBlock_Runtime is:'     $UNSETVAR_NOVARIABLESBLOCK_RUNTIME

- script: |
    echo 'SECUREDVAR is:'               $SECUREDVAR
    echo 'securedVar_Macro is:'         $SECUREDVAR_MACRO
    test "$SECUREDVAR_MACRO" && echo "truthy" || echo "falsy"
    echo 'securedVar_CompileTime is:'   $SECUREDVAR_COMPILETIME
    test "$SECUREDVAR_COMPILETIME" && echo "truthy" || echo "falsy"
    echo 'securedVar_Runtime is:'       $SECUREDVAR_RUNTIME
    test "$SECUREDVAR_RUNTIME" && echo "truthy" || echo "falsy"
    echo 'securedVar_NoVariablesBlock_Macro is:'       $SECUREDVAR_NOVARIABLESBLOCK_MACRO
    test "$SECUREDVAR_NOVARIABLESBLOCK_MACRO" && echo "truthy" || echo "falsy"
    echo 'securedVar_NoVariablesBlock_CompileTime is:' $SECUREDVAR_NOVARIABLESBLOCK_COMPILETIME
    test "$SECUREDVAR_NOVARIABLESBLOCK_COMPILETIME" && echo "truthy" || echo "falsy"
    echo 'securedVar_NoVariablesBlock_Runtime is:'     $SECUREDVAR_NOVARIABLESBLOCK_RUNTIME
    test "$SECUREDVAR_NOVARIABLESBLOCK_RUNTIME" && echo "truthy" || echo "falsy"

    echo
    echo 'PUBLICVAR is:'               $PUBLICVAR
    echo 'publicVar_Macro is:'         $PUBLICVAR_MACRO
    test "$PUBLICVAR_MACRO" && echo "truthy" || echo "falsy"
    echo 'publicVar_CompileTime is:'   $PUBLICVAR_COMPILETIME
    test "$PUBLICVAR_COMPILETIME" && echo "truthy" || echo "falsy"
    echo 'publicVar_Runtime is:'       $PUBLICVAR_RUNTIME
    test "$PUBLICVAR_RUNTIME" && echo "truthy" || echo "falsy"
    echo 'publicVar_NoVariablesBlock_Macro is:'       $PUBLICVAR_NOVARIABLESBLOCK_MACRO
    test "$PUBLICVAR_NOVARIABLESBLOCK_MACRO" && echo "truthy" || echo "falsy"
    echo 'publicVar_NoVariablesBlock_CompileTime is:' $PUBLICVAR_NOVARIABLESBLOCK_COMPILETIME
    test "$PUBLICVAR_NOVARIABLESBLOCK_COMPILETIME" && echo "truthy" || echo "falsy"
    echo 'publicVar_NoVariablesBlock_Runtime is:'     $PUBLICVAR_NOVARIABLESBLOCK_RUNTIME
    test "$PUBLICVAR_NOVARIABLESBLOCK_RUNTIME" && echo "truthy" || echo "falsy"

    echo
    echo 'UNSETVAR is:'               $UNSETVAR
    echo 'unsetVar_Macro is:'         $UNSETVAR_MACRO
    test "$UNSETVAR_MACRO" && echo "truthy" || echo "falsy"
    echo 'unsetVar_CompileTime is:'   $UNSETVAR_COMPILETIME
    test "$UNSETVAR_COMPILETIME" && echo "truthy" || echo "falsy"
    echo 'unsetVar_Runtime is:'       $UNSETVAR_RUNTIME
    test "$UNSETVAR_RUNTIME" && echo "truthy" || echo "falsy"
    echo 'unsetVar_NoVariablesBlock_Macro is:'       $UNSETVAR_NOVARIABLESBLOCK_MACRO
    test "$UNSETVAR_NOVARIABLESBLOCK_MACRO" && echo "truthy" || echo "falsy"
    echo 'unsetVar_NoVariablesBlock_CompileTime is:' $UNSETVAR_NOVARIABLESBLOCK_COMPILETIME
    test "$UNSETVAR_NOVARIABLESBLOCK_COMPILETIME" && echo "truthy" || echo "falsy"
    echo 'unsetVar_NoVariablesBlock_Runtime is:'     $UNSETVAR_NOVARIABLESBLOCK_RUNTIME
    test "$UNSETVAR_NOVARIABLESBLOCK_RUNTIME" && echo "truthy" || echo "falsy"

  env:
    securedVar_Macro: $(securedVar)
    securedVar_CompileTime: ${{variables.securedVar}}
    securedVar_Runtime: $[variables.securedVar]
    securedVar_NoVariablesBlock_Macro: $(securedVar_NoVariablesBlock)
    securedVar_NoVariablesBlock_CompileTime: ${{variables.securedVar_NoVariablesBlock}}
    securedVar_NoVariablesBlock_Runtime: $[variables.securedVar_NoVariablesBlock]
    publicVar_Macro: $(publicVar)
    publicVar_CompileTime: ${{variables.publicVar}}
    publicVar_Runtime: $[variables.publicVar]
    publicVar_NoVariablesBlock_Macro: $(publicVar_NoVariablesBlock)
    publicVar_NoVariablesBlock_CompileTime: ${{variables.publicVar_NoVariablesBlock}}
    publicVar_NoVariablesBlock_Runtime: $[variables.publicVar_NoVariablesBlock]
    unsetVar_Macro: $(unsetVar)
    unsetVar_CompileTime: ${{variables.unsetVar}}
    unsetVar_Runtime: $[variables.unsetVar]
    unsetVar_NoVariablesBlock_Macro: $(unsetVar_NoVariablesBlock)
    unsetVar_NoVariablesBlock_CompileTime: ${{variables.unsetVar_NoVariablesBlock}}
    unsetVar_NoVariablesBlock_Runtime: $[variables.unsetVar_NoVariablesBlock]
